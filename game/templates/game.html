<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Zack's Digital Journey - Game</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .character {
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center bottom;
        }
        
        /* 移除半透明背景，仅使用默认图片 */
        .character.error {
            background-color: transparent;
        }
    </style>
    <!-- 加载调试工具脚本 -->
    <script src="{{ url_for('static', filename='js/debug_tools.js') }}?v={{ (now.strftime('%Y%m%d%H%M%S') if now is callable else now.strftime('%Y%m%d%H%M%S')) if now is defined else '' }}"></script>
</head>
<body>
    <div class="game-container">
        <!-- 状态栏 -->
        <div class="status-bar">
            <div class="status-item">
                <span>Fans:</span>
                <span id="fans-count">0</span>
            </div>
            <div class="status-item">
                <span>Health:</span>
                <span id="health-value">100</span>
            </div>
            <div class="status-item">
                <span>Social:</span>
                <span id="social-value">50</span>
            </div>
            <div class="status-item">
                <span>Security Awareness:</span>
                <span id="security-value">50</span>
            </div>
            <div class="status-item">
                <span>Day:</span>
                <span id="day-count">1</span>
            </div>
        </div>

        <!-- Quiz 倒计时柱状图容器 -->
        <div id="quiz-timer-bar-container" style="position:absolute;top:70px;left:50%;transform:translateX(-50%);width:90%;height:18px;background:#f1f1f1;border-radius:10px;box-shadow:0 2px 5px rgba(0,0,0,0.2);display:none;z-index:1000;">
            <div id="quiz-timer-bar" style="width:100%;height:100%;background:#4CAF50;border-radius:10px;transition:width 1s linear;"></div>
        </div>

        <!-- Quiz 题目显示容器 -->
        <div id="quiz-container" style="position:absolute;top:100px;left:50%;transform:translateX(-50%);width:80%;max-width:600px;padding:20px;background:rgba(255,255,255,0.95);border-radius:10px;box-shadow:0 4px 20px rgba(0,0,0,0.3);display:none;z-index:1000;">
            <div id="quiz-question-text" style="font-size:20px;color:#333;margin-bottom:15px;text-align:center;">Loading question...</div>
            <div id="quiz-question-choices" style="display:flex;flex-direction:column;gap:10px;"></div>
        </div>

        <!-- 游戏主画面 -->
        <div class="game-screen">
            <div class="background" id="background"></div>
            <div class="character left" id="character-left"></div>
            <div class="character right" id="character-right"></div>
            <div class="dialog-box">
                <div class="speaker-name" id="speaker-name"></div>
                <div class="dialog-text" id="dialog-text"></div>
                <div class="choices" id="choices"></div>
            </div>
        </div>
    </div>
    
    <!-- 先加载资源重定向脚本 -->
    <script src="{{ url_for('static', filename='js/resource_redirect.js') }}?v={{ (now.strftime('%Y%m%d%H%M%S') if now is callable else now.strftime('%Y%m%d%H%M%S')) if now is defined else '' }}"></script>
    
    <!-- 再加载辅助脚本和修复脚本 -->
    <script src="{{ url_for('static', filename='js/image_path_fix.js') }}?v={{ (now.strftime('%Y%m%d%H%M%S') if now is callable else now.strftime('%Y%m%d%H%M%S')) if now is defined else '' }}"></script>
    <script src="{{ url_for('static', filename='js/variable_fix.js') }}?v={{ (now.strftime('%Y%m%d%H%M%S') if now is callable else now.strftime('%Y%m%d%H%M%S')) if now is defined else '' }}"></script>
    <script src="{{ url_for('static', filename='js/game_init_fix.js') }}?v={{ (now.strftime('%Y%m%d%H%M%S') if now is callable else now.strftime('%Y%m%d%H%M%S')) if now is defined else '' }}"></script>
    <script src="{{ url_for('static', filename='js/event_jump_fix.js') }}?v={{ (now.strftime('%Y%m%d%H%M%S') if now is callable else now.strftime('%Y%m%d%H%M%S')) if now is defined else '' }}"></script>
    <script src="{{ url_for('static', filename='js/music_controller.js') }}?v={{ (now.strftime('%Y%m%d%H%M%S') if now is callable else now.strftime('%Y%m%d%H%M%S')) if now is defined else '' }}"></script>
    
    <!-- 然后加载事件处理器 -->
    <script src="{{ url_for('static', filename='js/weekend_event_handler.js') }}?v={{ (now.strftime('%Y%m%d%H%M%S') if now is callable else now.strftime('%Y%m%d%H%M%S')) if now is defined else '' }}"></script>
    <script src="{{ url_for('static', filename='js/weekend_event_2_handler.js') }}?v={{ (now.strftime('%Y%m%d%H%M%S') if now is callable else now.strftime('%Y%m%d%H%M%S')) if now is defined else '' }}"></script>
    <script src="{{ url_for('static', filename='js/regular_event_handler.js') }}?v={{ (now.strftime('%Y%m%d%H%M%S') if now is callable else now.strftime('%Y%m%d%H%M%S')) if now is defined else '' }}"></script>
    
    <!-- 最后加载主游戏脚本 -->
    <script src="{{ url_for('static', filename='js/game.js') }}?v={{ (now.strftime('%Y%m%d%H%M%S') if now is callable else now.strftime('%Y%m%d%H%M%S')) if now is defined else '' }}"></script>
    
    <!-- 游戏初始化脚本 -->
    <script src="{{ url_for('static', filename='js/game_init.js') }}?v={{ (now.strftime('%Y%m%d%H%M%S') if now is callable else now.strftime('%Y%m%d%H%M%S')) if now is defined else '' }}"></script>
</body>
</html> 